<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link th:href="@{/css/layout1.css}" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <style>
        .fieldError {
            color: #bd2130;
            }
    </style>

    <script th:inline="javascript">

        $(document).ready(function(){
            $(".closePopup").on("click",function() {
                console.log("닫기");
                closePopup();
            });

            var errorMessage = [[${errorMessage}]];
            if(errorMessage != null){
                alert(errorMessage);
            }

            var successMessage = [[${successMessage}]];
            if(successMessage != null){
                alert(successMessage);

                opener.location.reload();
                window.open('','_self').close();
            }
        });

        function closePopup() {
            window.open('','_self').close();
        }
    </script>

</head>
<body>
<div>
    <nav class="navbar navbar-expand-sm bg-primary navbar-dark">
        <span class="navbar-brand">할인정보 등록/수정</span>
    </nav>
</div>
<div>
    <form role="form" method="POST" action="/admin/item/discountPopup" th:object="${itemDiscountPopupDto}" >
        <div>
            <label th:for="discountDate">할인일</label>
            <input type="date" th:field="*{discountDate}"> <br>
            <p th:if="${#fields.hasErrors('discountDate')}" th:errors="*{discountDate}" class="fieldError">Incorrect data</p>
        </div>
        <div>
            할인시간 <select th:name="discountTime">
                        <option VALUE="0" th:selected="*{discountTime == null}">선택해주세요.</option>
                        <option VALUE="ONE" th:selected="*{discountTime eq 'ONE'}">1 (00시 ~ 04시)</option>
                        <option VALUE="TWO" th:selected="*{discountTime eq 'TWO'}">2 (04시 ~ 08시)</option>
                        <option VALUE="THREE" th:selected="*{discountTime eq 'THREE'}">3 (08시 ~ 12시)</option>
                        <option VALUE="FOUR" th:selected="*{discountTime eq 'FOUR'}">4 (12시 ~ 16시)</option>
                        <option VALUE="FIVE" th:selected="*{discountTime eq 'FIVE'}">5 (16시 ~ 20시)</option>
                        <option VALUE="SIX" th:selected="*{discountTime eq 'SIX'}">6 (20시 ~ 24시)</option>
                    </select> <br>
            <p th:if="${#fields.hasErrors('discountTime')}" th:errors="*{discountTime}" class="fieldError">Incorrect data</p>
        </div>
        <div>
            할인율 <input type="text" th:field="*{discountRate}">% <br>
            <p th:if="${#fields.hasErrors('discountRate')}" th:errors="*{discountRate}" class="fieldError">Incorrect data</p>
        </div>
        <div>
            <input type="button" value="취소" class="closePopup">
            <input type="submit" value="저장">
        </div>
        <input type="hidden" th:field="*{id}">
        <input type="hidden" th:name="itemId" th:value="${itemId}">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
    </form>
</div>
</body>
</html>